<!doctype html>
<html lang="ja">
<head>
	<meta charset="utf-8">
	<title>minify-sample</title>
	<script type="text/javascript" src="./assets/minifyset.config.js"></script>
	<script type="text/javascript" src="./minifyset.loader.js"></script>
	<script>
	hljs.configure({
		tabReplace: '    ', // スペース4つ
	})
	hljs.initHighlightingOnLoad();
	</script>
</head>



<body>
<div class="container">
	<h5>■ minifysetの使い方</h5>
	<article>
		| minifysetの環境をつくる |
		<a href="./dir1">minify化する</a> |
		<a href="./dir1/dir2/">サンプルページ</a> |
		<a href="https://github.com/chaordicorg/minifyset/" target="_blank">ダウンロード</a> |
	</article>

	<main>

		<h1>概要と利点</h1>
		<article>
			<p>これは、JSやCSSファイルを圧縮して一つのファイルにまとめるためのセットです。</p>
			<p>この手のツールでは現在 webpack が主流ですが、node.js によるモダンな開発環境を構築しなければならず、また、設定も複雑なので敷居が高いです。ごく普通のWEBページでも、ヘッダーにずらっとならんだJSライブラリやCSSをひとまとめにできないかと思ってつくりました。圧縮化（minify化）はPHPのライブラリ <a href="https://github.com/matthiasmullie/minify" target="_blank">minify</a> を使っています。</p>
			<p>XAMPP や MAMP などでローカルサーバの開発環境を用意する必要があります。</p>
			<ul>
				<li>ファイルが圧縮され一つのファイルになるので、読み込み時間が軽減される。</li>
				<li>コメントが削除されるので、セキュリティ的な懸念が減る。</li>
				<li>開発時に、JSやCSSのファイルをいくらでも分割できる。</li>
			</li>
		</article>

		<h1>minifysetの環境をつくる</h1>

		<article>
			<div class="alert alert-success" role="alert">
				<strong>1</strong>：　対象ページに読み込むファイルと、minify化したファイルの出力先を設定する「minifyset.config.js」を作ります。<br>
				（※同ディレクトリに複数の設定ファイルを設置したい場合は「minifyset.config.***.js」とします。）
			</div>
			<div class="alert alert-danger" role="alert">
				<strong>注意</strong>：　このファイルは対象ページごとに作成する必要があります。「base:」に設定するパスが「対象ページからコンテンツ・ルートへの相対パス」であることに注意してください。仮に「dir1」というディレクトリの配下に置かれる場合 base は「./dir1」と指定します。
			</div>
<pre><code>var _minconfig = {
	"base": ".", // 対象ページからコンテンツ・ルートへの相対パス
	"set": [
		{
			// -- 読み込むCSSファイル
			"type": "css",
			"files":[
				"./common/css/common.css",
				"./assets/css/top.css",
				"./common/lib/bootstrap-4.5.3.css",
				"./common/lib/highlightjs-railscasts.min.css",
			],
			"minify": "./assets/css/top.min.css" // minify化したCSSファイルの出力先
		},
		{
			// -- 読み込むJSファイル
			"type": "js",
			"files":[
				"./common/lib/jquery-3.6.0.js",
				"./common/lib/bootstrap-4.5.3.js",
				"./common/lib/highlight.min.js",
				"./common/lib/jquery.clone_blocks.js",
				"./common/lib/jquery.inview.min.js",
				"assets/js/top.js",
			],
			"minify": "./assets/js/top.min.js"	// minify化したJSファイルの出力先
		}
	]
}
</code></pre>
		</article>

		<article>
			<div class="alert alert-success" role="alert">
				<p><strong>2</strong>：　「_minifyset/」と「minifyset.loader.js」をコンテンツ・ルートに置きます。</p>
				「_minifyset/」は、minify化を実行するファイルが入っています。公開サーバーにアップロードしないでください。<br>
				「minifyset.loader.js」は、ローカル環境か公開環境かを判断して、それぞれ別のファイルを読み込む処理をします。
			</div>
			<div class="alert alert-danger" role="alert">
				<strong>注意</strong>：　「_minifyset/」フォルダは、公開サーバーにアップロードしないでください。
			</div>
			<div class="alert alert-success" role="alert">
				<strong>3</strong>：　「minifyset.config.js」を任意のディレクトリに置きます（例では「assets/」 の中）。
			</div>
<pre><code>コンテンツ・ルート/
	├ _minifyset/ * minify化する実行ファイル群
	├ assets/
	│	├ css/
	│	|	└ top.css
	│	├ js/
	│	|	└ top.js
	│	└ minifyset.config.js *
	└ common/
	index.html
	minifyset.loader.js *
</code></pre>
		</article>

		<article>
			<div class="alert alert-success" role="alert">
				<strong>4</strong>：　対象ページに「minifyset.config.js」と「minifyset.loader.js」を読み込みます。
			</div>
<pre><code>&lt;script type="text/javascript" src="./assets/minifyset.config.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="./minifyset.loader.js"&gt;&lt;/script&gt;
</code></pre>
		</article>

	</main>
</div>




<!--
<script>
// 特殊文字をエスケープせずにHTMLのソースコードをそのまま表示させる
// https://bit.ly/3kKtalN
document.querySelectorAll('pre > code').forEach(function(elem){
	elem.textContent = elem.innerHTML.trim();
});
</script>
-->



</body>



</html>